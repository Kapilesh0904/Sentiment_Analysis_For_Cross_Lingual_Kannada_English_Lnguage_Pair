{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":34980,"status":"ok","timestamp":1681825944841,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"lKARuXLSLYY8","outputId":"b2275872-2613-4d74-d4c3-3c4634e7841c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting ktrain\n","  Downloading ktrain-0.35.1.tar.gz (25.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m25.3/25.3 MB\u001b[0m \u001b[31m54.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/dist-packages (from ktrain) (1.2.2)\n","Requirement already satisfied: matplotlib>=3.0.0 in /usr/local/lib/python3.9/dist-packages (from ktrain) (3.7.1)\n","Requirement already satisfied: pandas>=1.0.1 in /usr/local/lib/python3.9/dist-packages (from ktrain) (1.5.3)\n","Requirement already satisfied: fastprogress>=0.1.21 in /usr/local/lib/python3.9/dist-packages (from ktrain) (1.0.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.9/dist-packages (from ktrain) (2.27.1)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.9/dist-packages (from ktrain) (1.2.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.9/dist-packages (from ktrain) (23.0)\n","Collecting langdetect\n","  Downloading langdetect-1.0.9.tar.gz (981 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m981.5/981.5 kB\u001b[0m \u001b[31m51.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: jieba in /usr/local/lib/python3.9/dist-packages (from ktrain) (0.42.1)\n","Collecting cchardet\n","  Downloading cchardet-2.1.7-cp39-cp39-manylinux2010_x86_64.whl (265 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m265.4/265.4 kB\u001b[0m \u001b[31m27.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: chardet in /usr/local/lib/python3.9/dist-packages (from ktrain) (4.0.0)\n","Collecting syntok>1.3.3\n","  Downloading syntok-1.4.4-py3-none-any.whl (24 kB)\n","Collecting tika\n","  Downloading tika-2.6.0.tar.gz (27 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting transformers>=4.17.0\n","  Downloading transformers-4.28.1-py3-none-any.whl (7.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.0/7.0 MB\u001b[0m \u001b[31m111.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting sentencepiece\n","  Downloading sentencepiece-0.1.98-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m75.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting keras_bert>=0.86.0\n","  Downloading keras-bert-0.89.0.tar.gz (25 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting whoosh\n","  Downloading Whoosh-2.7.4-py2.py3-none-any.whl (468 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m468.8/468.8 kB\u001b[0m \u001b[31m44.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.9/dist-packages (from keras_bert>=0.86.0->ktrain) (1.22.4)\n","Collecting keras-transformer==0.40.0\n","  Downloading keras-transformer-0.40.0.tar.gz (9.7 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-pos-embd==0.13.0\n","  Downloading keras-pos-embd-0.13.0.tar.gz (5.6 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-multi-head==0.29.0\n","  Downloading keras-multi-head-0.29.0.tar.gz (13 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-layer-normalization==0.16.0\n","  Downloading keras-layer-normalization-0.16.0.tar.gz (3.9 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-position-wise-feed-forward==0.8.0\n","  Downloading keras-position-wise-feed-forward-0.8.0.tar.gz (4.1 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-embed-sim==0.10.0\n","  Downloading keras-embed-sim-0.10.0.tar.gz (3.6 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting keras-self-attention==0.51.0\n","  Downloading keras-self-attention-0.51.0.tar.gz (11 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (3.0.9)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (4.39.3)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (1.0.7)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (0.11.0)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (2.8.2)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (1.4.4)\n","Requirement already satisfied: importlib-resources>=3.2.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (5.12.0)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib>=3.0.0->ktrain) (8.4.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.9/dist-packages (from pandas>=1.0.1->ktrain) (2022.7.1)\n","Requirement already satisfied: regex>2016 in /usr/local/lib/python3.9/dist-packages (from syntok>1.3.3->ktrain) (2022.10.31)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.9/dist-packages (from transformers>=4.17.0->ktrain) (3.11.0)\n","Collecting huggingface-hub<1.0,>=0.11.0\n","  Downloading huggingface_hub-0.13.4-py3-none-any.whl (200 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m200.1/200.1 kB\u001b[0m \u001b[31m25.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.9/dist-packages (from transformers>=4.17.0->ktrain) (4.65.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.9/dist-packages (from transformers>=4.17.0->ktrain) (6.0)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m78.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: six in /usr/local/lib/python3.9/dist-packages (from langdetect->ktrain) (1.16.0)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.9/dist-packages (from requests->ktrain) (2.0.12)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.9/dist-packages (from requests->ktrain) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.9/dist-packages (from requests->ktrain) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.9/dist-packages (from requests->ktrain) (3.4)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->ktrain) (3.1.0)\n","Requirement already satisfied: scipy>=1.3.2 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->ktrain) (1.10.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.9/dist-packages (from tika->ktrain) (67.6.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.9/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers>=4.17.0->ktrain) (4.5.0)\n","Requirement already satisfied: zipp>=3.1.0 in /usr/local/lib/python3.9/dist-packages (from importlib-resources>=3.2.0->matplotlib>=3.0.0->ktrain) (3.15.0)\n","Building wheels for collected packages: ktrain, keras_bert, keras-transformer, keras-embed-sim, keras-layer-normalization, keras-multi-head, keras-pos-embd, keras-position-wise-feed-forward, keras-self-attention, langdetect, tika\n","  Building wheel for ktrain (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for ktrain: filename=ktrain-0.35.1-py3-none-any.whl size=25316191 sha256=979f7df55e99a911bc3203fa6b22203c2ae5713c4259e167525e2ab112d70341\n","  Stored in directory: /root/.cache/pip/wheels/3f/86/fe/b944ff9fb89c0ce9aab68e7a0c5d53c98c52ae0326fe0942ca\n","  Building wheel for keras_bert (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras_bert: filename=keras_bert-0.89.0-py3-none-any.whl size=33517 sha256=8913ab26e01cfec839d40a64a80c4088f3597bb2a3af1c3cc0f058e21f1b1bb1\n","  Stored in directory: /root/.cache/pip/wheels/4e/26/24/14ecbc0166364db7f5500164b7d796263cf3cd10c57e892180\n","  Building wheel for keras-transformer (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-transformer: filename=keras_transformer-0.40.0-py3-none-any.whl size=12303 sha256=c28d25e1e50e9ed7036c74c4c09571d9e95a8af66bfa4819e190bdbbdeb89e79\n","  Stored in directory: /root/.cache/pip/wheels/5e/d6/d1/c588c3b2b112c8f1173934995836ab2f2de8323cce99fa998f\n","  Building wheel for keras-embed-sim (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-embed-sim: filename=keras_embed_sim-0.10.0-py3-none-any.whl size=3959 sha256=f2ff4a33fab10bc4c0be5c85e3f1d6659f6e915ab7a0add4092d3c976dd27c5d\n","  Stored in directory: /root/.cache/pip/wheels/cb/25/02/4bb438785ef9c10d07f6b3519f080b38917153fdac3108d738\n","  Building wheel for keras-layer-normalization (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-layer-normalization: filename=keras_layer_normalization-0.16.0-py3-none-any.whl size=4666 sha256=c3397765cdfda8935f05c8e1928e6c91c09a905032d85b59477530c975a66a78\n","  Stored in directory: /root/.cache/pip/wheels/c1/df/15/a88cdf68ce687574649f65063a743123e1bee79932b6eea3b6\n","  Building wheel for keras-multi-head (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-multi-head: filename=keras_multi_head-0.29.0-py3-none-any.whl size=14992 sha256=40b83a203eb51d526dc1f6f417b271832a2e2bbb82daabd0d40f9b16cad583b0\n","  Stored in directory: /root/.cache/pip/wheels/b3/85/50/f232cac81ed1eb4dc20db31a9d1f4a8a1a8c696d4d27bff442\n","  Building wheel for keras-pos-embd (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-pos-embd: filename=keras_pos_embd-0.13.0-py3-none-any.whl size=6958 sha256=128a6b8704270647256bb1f60e4bd7f5c7e227670cf257af2891d106febbf4f1\n","  Stored in directory: /root/.cache/pip/wheels/f5/8c/9a/917bf72d493e084ca1706a02679185789c2715f50770d8c987\n","  Building wheel for keras-position-wise-feed-forward (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-position-wise-feed-forward: filename=keras_position_wise_feed_forward-0.8.0-py3-none-any.whl size=4983 sha256=cbdbf9dc10ad9becd5ee667059fe0dfcd680316f7a53142c0acfa49412bed7c6\n","  Stored in directory: /root/.cache/pip/wheels/20/36/25/efb605ab1742a179274a6f7cb113da1c6758f45e212b59bb4d\n","  Building wheel for keras-self-attention (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for keras-self-attention: filename=keras_self_attention-0.51.0-py3-none-any.whl size=18910 sha256=e37e2bd1676242806ae738f3a5eeeca86748901eb2a73393472e8eaa34e38ac7\n","  Stored in directory: /root/.cache/pip/wheels/78/c1/84/b83a2fd6f1d63e136cba74bac4126bee3b8705eef6486635fd\n","  Building wheel for langdetect (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for langdetect: filename=langdetect-1.0.9-py3-none-any.whl size=993243 sha256=cb94421e863adb30c5fffce93da666d80ae7849c11ede331db99929a7e340bae\n","  Stored in directory: /root/.cache/pip/wheels/d1/c1/d9/7e068de779d863bc8f8fc9467d85e25cfe47fa5051fff1a1bb\n","  Building wheel for tika (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for tika: filename=tika-2.6.0-py3-none-any.whl size=32641 sha256=970795c56d93794236bde2a1c9d240dafe8a57a1c9ff6d1c2190cd50d19c4129\n","  Stored in directory: /root/.cache/pip/wheels/13/56/18/e752060632d32c39c9c4545e756dad281f8504dafcfac02b95\n","Successfully built ktrain keras_bert keras-transformer keras-embed-sim keras-layer-normalization keras-multi-head keras-pos-embd keras-position-wise-feed-forward keras-self-attention langdetect tika\n","Installing collected packages: whoosh, tokenizers, sentencepiece, cchardet, syntok, langdetect, keras-self-attention, keras-position-wise-feed-forward, keras-pos-embd, keras-layer-normalization, keras-embed-sim, tika, keras-multi-head, huggingface-hub, transformers, keras-transformer, keras_bert, ktrain\n","Successfully installed cchardet-2.1.7 huggingface-hub-0.13.4 keras-embed-sim-0.10.0 keras-layer-normalization-0.16.0 keras-multi-head-0.29.0 keras-pos-embd-0.13.0 keras-position-wise-feed-forward-0.8.0 keras-self-attention-0.51.0 keras-transformer-0.40.0 keras_bert-0.89.0 ktrain-0.35.1 langdetect-1.0.9 sentencepiece-0.1.98 syntok-1.4.4 tika-2.6.0 tokenizers-0.13.3 transformers-4.28.1 whoosh-2.7.4\n"]}],"source":["!pip install ktrain"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iE4BkBJqLuIz"},"outputs":[],"source":["import numpy as np\n","import ktrain\n","from ktrain import text\n","import pandas as pd\n","from sklearn.model_selection import train_test_split"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":372},"executionInfo":{"elapsed":21,"status":"ok","timestamp":1681825950746,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"vbtT6c7HL_cW","outputId":"cdf183ef-2589-4b3f-ff90-ba948da57474"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0.1  Unnamed: 0  Sentiment  \\\n","0             0           0          0   \n","1             1           1          3   \n","2             2           2          0   \n","3             3           3          1   \n","4             4           4          0   \n","\n","                                  Cross_Lingual_Text  \\\n","0              Sir nivu news helida hage heltiri sir   \n","1                                      Idu riyel rar   \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆ.ಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ...   \n","3  Ashwathama. Vadhukkidhe.evathu. video. Nodithu...   \n","4  ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ........ ಚಾ ಕುಡ...   \n","\n","                                      Processed_text  \\\n","0              Sir nivu news helida hage heltiri sir   \n","1                                      Idu riyel rar   \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...   \n","3  Ashwathama Vadhukkidheevathu video Nodithunanu...   \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ   \n","\n","                                     Translated_text  \\\n","0            ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್   \n","1                                    ಇದು ರಿಯೆಲ್ ರಾರ್   \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...   \n","3     ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ   \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ   \n","\n","                                        FULL_kannada  \n","0            ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್  \n","1                                    ಇದು ರಿಯೆಲ್ ರಾರ್  \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...  \n","3     ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ  \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ  "],"text/html":["\n","  <div id=\"df-aee17779-135f-49b5-ac9a-71c055795169\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0.1</th>\n","      <th>Unnamed: 0</th>\n","      <th>Sentiment</th>\n","      <th>Cross_Lingual_Text</th>\n","      <th>Processed_text</th>\n","      <th>Translated_text</th>\n","      <th>FULL_kannada</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>Sir nivu news helida hage heltiri sir</td>\n","      <td>Sir nivu news helida hage heltiri sir</td>\n","      <td>ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್</td>\n","      <td>ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>Idu riyel rar</td>\n","      <td>Idu riyel rar</td>\n","      <td>ಇದು ರಿಯೆಲ್ ರಾರ್</td>\n","      <td>ಇದು ರಿಯೆಲ್ ರಾರ್</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆ.ಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>Ashwathama. Vadhukkidhe.evathu. video. Nodithu...</td>\n","      <td>Ashwathama Vadhukkidheevathu video Nodithunanu...</td>\n","      <td>ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ</td>\n","      <td>ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ........ ಚಾ ಕುಡ...</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aee17779-135f-49b5-ac9a-71c055795169')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-aee17779-135f-49b5-ac9a-71c055795169 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-aee17779-135f-49b5-ac9a-71c055795169');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":3}],"source":["df = pd.read_csv(\"/content/removed_not.csv\")\n","df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":320},"executionInfo":{"elapsed":18,"status":"ok","timestamp":1681825950747,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"ArfWmirYMJqE","outputId":"5b5dcbd4-8e12-47f7-d035-22b9a1202a0b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Sentiment                                 Cross_Lingual_Text  \\\n","0          0              Sir nivu news helida hage heltiri sir   \n","1          3                                      Idu riyel rar   \n","2          0  ಕಥೆ ಅರ್ದ ಅಗಿದೆ.ಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ...   \n","3          1  Ashwathama. Vadhukkidhe.evathu. video. Nodithu...   \n","4          0  ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ........ ಚಾ ಕುಡ...   \n","\n","                                      Processed_text  \\\n","0              Sir nivu news helida hage heltiri sir   \n","1                                      Idu riyel rar   \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...   \n","3  Ashwathama Vadhukkidheevathu video Nodithunanu...   \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ   \n","\n","                                     Translated_text  \\\n","0            ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್   \n","1                                    ಇದು ರಿಯೆಲ್ ರಾರ್   \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...   \n","3     ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ   \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ   \n","\n","                                        FULL_kannada  \n","0            ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್  \n","1                                    ಇದು ರಿಯೆಲ್ ರಾರ್  \n","2  ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...  \n","3     ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ  \n","4     ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ  "],"text/html":["\n","  <div id=\"df-b078a93f-adbf-44ae-9e57-4358526a6f4c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Sentiment</th>\n","      <th>Cross_Lingual_Text</th>\n","      <th>Processed_text</th>\n","      <th>Translated_text</th>\n","      <th>FULL_kannada</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>Sir nivu news helida hage heltiri sir</td>\n","      <td>Sir nivu news helida hage heltiri sir</td>\n","      <td>ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್</td>\n","      <td>ಸರ್ ನೀವು ನ್ಯೂಸ್ ಹೇಳಿದ ಹಾಗೆ ಹೇಳ್ತಿರಿ ಸರ್</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>3</td>\n","      <td>Idu riyel rar</td>\n","      <td>Idu riyel rar</td>\n","      <td>ಇದು ರಿಯೆಲ್ ರಾರ್</td>\n","      <td>ಇದು ರಿಯೆಲ್ ರಾರ್</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆ.ಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","      <td>ಕಥೆ ಅರ್ದ ಅಗಿದೆಅಶ್ವತ್ತಾಮ ತನ್ಣಗಾಯಗೊಂಡ ದೇಹವನ್ನು ಗ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>Ashwathama. Vadhukkidhe.evathu. video. Nodithu...</td>\n","      <td>Ashwathama Vadhukkidheevathu video Nodithunanu...</td>\n","      <td>ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ</td>\n","      <td>ಅಶ್ವಥಮ ವಧುಕ್ಕಿದೀವತು ವಿಡಿಯೋ ನೋಡಿತುನನು ಜೈ ಬಾಬಾಜಿ</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ........ ಚಾ ಕುಡ...</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","      <td>ಹೌದು ಹೌದು ನಿನ್ನೆ ನಮ್ಮನಿಗೂ ಬಂದಿದ ಚಾ ಕುಡ್ಕಾ ಹೊದ</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b078a93f-adbf-44ae-9e57-4358526a6f4c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b078a93f-adbf-44ae-9e57-4358526a6f4c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b078a93f-adbf-44ae-9e57-4358526a6f4c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}],"source":["df = df.drop(['Unnamed: 0'],axis = 1)\n","df = df.drop(['Unnamed: 0.1'],axis = 1)\n","df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17,"status":"ok","timestamp":1681825950747,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"_3PMqWZDh9G4","outputId":"3e6a1a92-168e-4142-d24c-67c4c70f0e9e"},"outputs":[{"output_type":"stream","name":"stdout","text":["1082\n","2900\n","547\n","718\n"]}],"source":["print(df['Sentiment'].value_counts()[0])\n","print(df['Sentiment'].value_counts()[1])\n","print(df['Sentiment'].value_counts()[2])\n","print(df['Sentiment'].value_counts()[3])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WPCZARiBMkWy"},"outputs":[],"source":["x_train, x_test, y_train, y_test = train_test_split(df['Translated_text'], df['Sentiment'], shuffle=True, test_size = 0.2, random_state=500, stratify=df['Sentiment'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aZXQP4d54NT-"},"outputs":[],"source":["x_train = x_train.to_numpy()\n","y_train = y_train.to_numpy()"]},{"cell_type":"markdown","metadata":{"id":"cqGZr4vhvU-v"},"source":["# BERT"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":159},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1681826696259,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"2YHJbshWvOIP","outputId":"2cfc8a84-ad45-4006-a3b2-dac1afc2714c"},"outputs":[{"output_type":"stream","name":"stdout","text":["preprocessing train...\n","language: kn\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<style>\n","    /* Turns off some styling */\n","    progress {\n","        /* gets rid of default border in Firefox and Opera. */\n","        border: none;\n","        /* Needs to be in here for Safari polyfill so background images work as expected. */\n","        background-size: auto;\n","    }\n","    progress:not([value]), progress:not([value])::-webkit-progress-bar {\n","        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);\n","    }\n","    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n","        background: #F44336;\n","    }\n","</style>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["done."]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Is Multi-Label? False\n","preprocessing test...\n","language: kn\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<style>\n","    /* Turns off some styling */\n","    progress {\n","        /* gets rid of default border in Firefox and Opera. */\n","        border: none;\n","        /* Needs to be in here for Safari polyfill so background images work as expected. */\n","        background-size: auto;\n","    }\n","    progress:not([value]), progress:not([value])::-webkit-progress-bar {\n","        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);\n","    }\n","    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n","        background: #F44336;\n","    }\n","</style>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["done."]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["task: text classification\n"]}],"source":["(x_train_bert,y_train_bert) , (x_val_bert,y_val_bert),preproc = text.texts_from_array(x_train = x_train,y_train = y_train,class_names = [\"0\",\"1\",\"2\",\"3\"],preprocess_mode='bert',lang = 'kn',maxlen = 65,max_features=35000)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8200,"status":"ok","timestamp":1681826704456,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"},"user_tz":-330},"id":"LlmArkzZ53vt","outputId":"d6505553-6e19-4b9c-b010-1c6093bca6b4"},"outputs":[{"output_type":"stream","name":"stdout","text":["Is Multi-Label? False\n","maxlen is 65\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.9/dist-packages/keras/initializers/initializers.py:120: UserWarning: The initializer GlorotNormal is unseeded and being called multiple times, which will return identical values each time (even if the initializer is unseeded). Please update your code to provide a seed to the initializer, or avoid using the same initalizer instance more than once.\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["done.\n"]}],"source":["model = text.text_classifier('bert',train_data = (x_train_bert,y_train_bert),preproc = preproc)\n","learner = ktrain.get_learner(model,train_data=(x_train_bert,y_train_bert),val_data=(x_val_bert,y_val_bert),batch_size = 16)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y90nYZLU7r-B"},"outputs":[],"source":["# learner.lr_find()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gk0fFr2PHwLF"},"outputs":[],"source":["# learner.lr_plot()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":588},"id":"aP71TU31J6Zs","executionInfo":{"status":"error","timestamp":1681826947043,"user_tz":-330,"elapsed":242603,"user":{"displayName":"Kapilesh Umakanth Dept of AI & ML","userId":"12492275401226615232"}},"outputId":"cafc8030-818a-4f55-a8e9-205c384d9bba"},"outputs":[{"output_type":"stream","name":"stdout","text":["early_stopping automatically enabled at patience=5\n","reduce_on_plateau automatically enabled at patience=2\n","\n","\n","begin training using triangular learning rate policy with max lr of 0.0001...\n","Epoch 1/1024\n","237/237 [==============================] - 98s 318ms/step - loss: 1.1835 - accuracy: 0.5470 - val_loss: 1.1377 - val_accuracy: 0.5762\n","Epoch 2/1024\n","237/237 [==============================] - 70s 295ms/step - loss: 1.1717 - accuracy: 0.5502 - val_loss: 1.1304 - val_accuracy: 0.5762\n","Epoch 3/1024\n","237/237 [==============================] - 70s 297ms/step - loss: 1.1699 - accuracy: 0.5502 - val_loss: 1.1280 - val_accuracy: 0.5762\n","Epoch 4/1024\n"," 16/237 [=>............................] - ETA: 1:02 - loss: 1.1481 - accuracy: 0.5625"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-27-5a330c125639>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mlearner\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mautofit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1e-4\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/ktrain/core.py\u001b[0m in \u001b[0;36mautofit\u001b[0;34m(self, lr, epochs, early_stopping, reduce_on_plateau, reduce_factor, cycle_momentum, max_momentum, min_momentum, monitor, checkpoint_folder, class_weight, callbacks, steps_per_epoch, verbose)\u001b[0m\n\u001b[1;32m   1223\u001b[0m             \u001b[0mverbose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mverbose\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1224\u001b[0m         )\n\u001b[0;32m-> 1225\u001b[0;31m         hist = self.fit(\n\u001b[0m\u001b[1;32m   1226\u001b[0m             \u001b[0mlr\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1227\u001b[0m             \u001b[0mepochs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/ktrain/core.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, lr, n_cycles, cycle_len, cycle_mult, lr_decay, checkpoint_folder, early_stopping, verbose, class_weight, callbacks, steps_per_epoch)\u001b[0m\n\u001b[1;32m   1393\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mwarnings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcatch_warnings\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1394\u001b[0m             \u001b[0mwarnings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfilterwarnings\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"ignore\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmessage\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\".*Check your callbacks.*\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1395\u001b[0;31m             hist = self.model.fit(\n\u001b[0m\u001b[1;32m   1396\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_train\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1397\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_prepare\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_train\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrain\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     63\u001b[0m         \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     64\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 65\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     66\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     67\u001b[0m             \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\u001b[0m\n\u001b[1;32m   1683\u001b[0m                         ):\n\u001b[1;32m   1684\u001b[0m                             \u001b[0mcallbacks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_train_batch_begin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1685\u001b[0;31m                             \u001b[0mtmp_logs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1686\u001b[0m                             \u001b[0;32mif\u001b[0m \u001b[0mdata_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshould_sync\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1687\u001b[0m                                 \u001b[0mcontext\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0masync_wait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/util/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    148\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    149\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 150\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    151\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    152\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/polymorphic_function/polymorphic_function.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    892\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    893\u001b[0m       \u001b[0;32mwith\u001b[0m \u001b[0mOptionalXlaContext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jit_compile\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 894\u001b[0;31m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    895\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    896\u001b[0m       \u001b[0mnew_tracing_count\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexperimental_get_tracing_count\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/polymorphic_function/polymorphic_function.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    924\u001b[0m       \u001b[0;31m# In this case we have created variables on the first call, so we run the\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    925\u001b[0m       \u001b[0;31m# defunned version which is guaranteed to never create variables.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 926\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_no_variable_creation_fn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# pylint: disable=not-callable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    927\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_variable_creation_fn\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    928\u001b[0m       \u001b[0;31m# Release the lock early so that multiple threads can perform the call\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m    141\u001b[0m       (concrete_function,\n\u001b[1;32m    142\u001b[0m        filtered_flat_args) = self._maybe_define_function(args, kwargs)\n\u001b[0;32m--> 143\u001b[0;31m     return concrete_function._call_flat(\n\u001b[0m\u001b[1;32m    144\u001b[0m         filtered_flat_args, captured_inputs=concrete_function.captured_inputs)  # pylint: disable=protected-access\n\u001b[1;32m    145\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/polymorphic_function/monomorphic_function.py\u001b[0m in \u001b[0;36m_call_flat\u001b[0;34m(self, args, captured_inputs, cancellation_manager)\u001b[0m\n\u001b[1;32m   1755\u001b[0m         and executing_eagerly):\n\u001b[1;32m   1756\u001b[0m       \u001b[0;31m# No tape is watching; skip to running the function.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1757\u001b[0;31m       return self._build_call_outputs(self._inference_function.call(\n\u001b[0m\u001b[1;32m   1758\u001b[0m           ctx, args, cancellation_manager=cancellation_manager))\n\u001b[1;32m   1759\u001b[0m     forward_backward = self._select_forward_and_backward_functions(\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/polymorphic_function/monomorphic_function.py\u001b[0m in \u001b[0;36mcall\u001b[0;34m(self, ctx, args, cancellation_manager)\u001b[0m\n\u001b[1;32m    379\u001b[0m       \u001b[0;32mwith\u001b[0m \u001b[0m_InterpolateFunctionError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    380\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcancellation_manager\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 381\u001b[0;31m           outputs = execute.execute(\n\u001b[0m\u001b[1;32m    382\u001b[0m               \u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msignature\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    383\u001b[0m               \u001b[0mnum_outputs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_num_outputs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.9/dist-packages/tensorflow/python/eager/execute.py\u001b[0m in \u001b[0;36mquick_execute\u001b[0;34m(op_name, num_outputs, inputs, attrs, ctx, name)\u001b[0m\n\u001b[1;32m     50\u001b[0m   \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     51\u001b[0m     \u001b[0mctx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mensure_initialized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 52\u001b[0;31m     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\n\u001b[0m\u001b[1;32m     53\u001b[0m                                         inputs, attrs, num_outputs)\n\u001b[1;32m     54\u001b[0m   \u001b[0;32mexcept\u001b[0m \u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_NotOkStatusException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["learner.autofit(1e-4)"]},{"cell_type":"markdown","metadata":{"id":"8ZfqvRL-QSG9"},"source":["## Prediction"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZzFpS-sCNxsS"},"outputs":[],"source":["predictor = ktrain.get_predictor(learner.model,preproc)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2rasRmawQM5y"},"outputs":[],"source":["test_df = pd.concat([x_test,y_test],axis=1)\n","test_df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eELQliEeSJPK"},"outputs":[],"source":["test_df['Predicted_Sentiment'] = predictor.predict(test_df['Translated_text'].to_list())\n","test_df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ga2jic5SVneY"},"outputs":[],"source":["test_df[\"Sentiment\"] = pd.to_numeric(test_df[\"Sentiment\"])\n","test_df[\"Predicted_Sentiment\"] = pd.to_numeric(test_df[\"Predicted_Sentiment\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gM50lqbGTcc8"},"outputs":[],"source":["from sklearn.metrics import accuracy_score, f1_score, precision_score, recall_score,confusion_matrix\n","cnf_matrix = confusion_matrix(test_df['Sentiment'],test_df['Predicted_Sentiment'])\n","cnf_matrix"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"An03_lx1WChP"},"outputs":[],"source":["acc = accuracy_score(test_df['Sentiment'],test_df['Predicted_Sentiment'])\n","macro_prec = precision_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average = 'macro')\n","macro_rec = recall_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average='macro')\n","macro_f1 = f1_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average='macro')\n","print('accuracy:%0.4f'%acc,'\\tprecision:%0.4f'%macro_prec,'\\trecall:%0.4f'%macro_rec,'\\tF1-score:%0.4f'%macro_f1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ONMfPedQaOOe"},"outputs":[],"source":["acc = accuracy_score(test_df['Sentiment'],test_df['Predicted_Sentiment'])\n","wt_prec = precision_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average = 'weighted')\n","wt_rec = recall_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average='weighted')\n","wt_f1 = f1_score(test_df['Sentiment'],test_df['Predicted_Sentiment'],average='weighted')\n","print('accuracy:%0.4f'%acc,'\\tprecision:%0.4f'%wt_prec,'\\trecall:%0.4f'%wt_rec,'\\tF1-score:%0.4f'%wt_f1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jEZ4XyThUIVp"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"10yNdV5Vs9Tl2A6WUJDohHh4805F8l4NS","timestamp":1679903361577}]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}